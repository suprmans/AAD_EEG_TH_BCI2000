<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>User Reference:SignalSharing - BCI2000 Help</title>
<link rel='shortcut icon' href='../../rsrc/favicon.ico' />
<style type='text/css'>
html { font-size:95%; font-family:arial,helvetica,sans-serif }
.printfooter { display:none }
#tocmain { font-size:81%; font-weight:bold; color:grey; background-color:white; border:1px solid black; padding:1em; z-index:10; position:fixed; left:-1px; top:-1px; width:150px; }
#tocmain a { color:black; text-decoration:none }
#tocmain ul { margin:0 0 0 0.4em; padding:0.1em 0 0 0.1em; list-style-position:outside; list-style-type:disc }
#tocmain li { text-indent:0; margin:0 0 0 1em; padding: 0 0 0 0 }
#tocmain p { margin:0; padding:0.1em 0 0 0.1em }
#tocmain .toc1 { margin-left:1.25em; }
#tocmain .toc2 { margin-left:2.25em; }
#tocmain .toc3 { margin-left:3.25em; }
#article { font-size:91%; position:absolute; left:200px; right:0; padding:1em; margin:0 }
</style>
</head>
<body>
 <div id='tocmain'>
 <a href='Main_Page.html'><img src='../../rsrc/bci2000logo.svg' alt='[Main Page]' /></a> <hr class="sep" /><p class="toc0"><a href="User_Tutorial%253ABCI2000_Tour.html">GettingStarted</a></p><ul></ul><p class="toc0"><a href="User_Reference%253AContents.html">User Manual</a></p><ul><li class="toc1"><a href="User_Reference%253AOperator_Module.html">Operator Module</a></li><li class="toc1"><a href="User_Reference%253AOperator_Module_Scripting.html">Operator Scripting</a></li><li class="toc1"><a href="User_Reference%253AModule_Command_Line_Options.html">Module Command Line Options</a></li><li class="toc1"><a href="User_Reference%253AData_File_Formats.html">Data File Formats</a></li><li class="toc1"><a href="User_Reference%253AFilters.html">Configuration Guide</a></li><li class="toc1"><a href="User_FAQ.html">FAQ</a></li><li class="toc1">Applications</li><ul><li class="toc2"><a href="User_Reference%253ACursorTask.html">Cursor Task</a></li><li class="toc2"><a href="User_Reference%253AP3SpellerTask.html">P3Speller Task</a></li><li class="toc2"><a href="https://www.bci2000.org/mediawiki/index.php/User_Reference:StimulusPresentation">Stimulus Presentation</a></li></ul><li class="toc1">Tools</li><ul><li class="toc2"><a href="User_Reference%253ABCI2000Launcher.html">BCI2000Launcher</a></li><li class="toc2"><a href="User_Reference%253ABCI2000Viewer.html">BCI2000Viewer</a></li><li class="toc2"><a href="User_Reference%253ABCI2000FileInfo.html">BCI2000FileInfo</a></li><li class="toc2"><a href="User_Reference%253ABCI2000Export.html">BCI2000Export</a></li><li class="toc2"><a href="User_Reference%253ABCI2000Analysis.html">BCI2000Analysis</a></li><li class="toc2"><a href="User_Reference%253ABCI2000_Offline_Analysis.html">BCI2000 Offline Analysis</a></li><li class="toc2"><a href="User_Reference%253ABCI2000Certification.html">BCI2000Certification</a></li><li class="toc2"><a href="User_Reference%253AEloc_Helper.html">Eloc Helper</a></li><li class="toc2"><a href="User_Reference%253AEEGLabImport.html">EEGLabImport</a></li><li class="toc2"><a href="User_Reference%253AMatlab_Tools.html">Matlab Tools</a></li><li class="toc2"><a href="User_Reference%253AMatlab_MEX_Files.html">Matlab MEX Files</a></li><li class="toc2"><a href="User_Reference%253ACommand_Line_Processing.html">Command Line Processing</a></li></ul></ul><p class="toc0"><a href="Technical_Reference%253AContents.html">Technical Reference</a></p><ul></ul><p class="toc0"><a href="Programming_Reference%253AContents.html">Programming Manual</a></p><ul></ul><p class="toc0"><a href="Contributions%253AContents.html">Contributions</a></p><ul></ul><hr class="sep" /><p class="toc0"><a href="BCI2000_Glossary.html">BCI2000 Glossary</a></p> </div>
 <div id='article'>
 <h1 class = "pagetitle">SignalSharing</h1>
 <p class = "subtitle">User Reference</p>
 <hr class = "sep" />
 <div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="User_Reference%253ASignalSharing.html#Synopsis"><span class="tocnumber">1</span> <span class="toctext">Synopsis</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="User_Reference%253ASignalSharing.html#Function"><span class="tocnumber">2</span> <span class="toctext">Function</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="User_Reference%253ASignalSharing.html#Data_Transmission"><span class="tocnumber">3</span> <span class="toctext">Data Transmission</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="User_Reference%253ASignalSharing.html#Back_Channel"><span class="tocnumber">4</span> <span class="toctext">Back Channel</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="User_Reference%253ASignalSharing.html#Configuration"><span class="tocnumber">5</span> <span class="toctext">Configuration</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="User_Reference%253ASignalSharing.html#Client_Examples"><span class="tocnumber">6</span> <span class="toctext">Client Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="User_Reference%253ASignalSharing.html#See_also"><span class="tocnumber">7</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Synopsis">Synopsis</span></h2>
<p><i>SignalSharing</i> allows to tap into BCI2000 processing by receiving any filter output signal through a combination of a TCP connection, and shared memory.
In addition, signal and state data may be modified from the client side, i.e. they may be injected into BCI2000.
</p>
<h2><span class="mw-headline" id="Function">Function</span></h2>
<p>The <i>SignalSharing</i> component in BCI2000 shares its input signal through a <tt>GenericSignal</tt> object which has been linked to a shared memory block using <tt>GenericSignal::ShareAcrossModules()</tt>. A dedicated thread waits for signal updates from the BCI2000 side, and sends signal and state data out to a separate application waiting on a TCP/IP connection. Also, the separate application may send signal and state data back to BCI2000 through the same connection.
</p><p>When the client application is running on a separate machine, full signal data are sent over the network. When the client is running on the same machine, only a reference to a shared memory block is sent. On the client side, a flag in the signal data block indicates whether full signal data is transmitted, or just the name of a shared memory block to which the client may connect in order to read data.
</p><p>To facilitate consistency with the <a href="Technical_Reference%253AStates_of_Operation.html" title="Technical Reference:States of Operation">BCI2000 model of operation</a>, <i>SignalSharing</i> is operating as a TCP client rather than a server. When BCI2000 goes into <tt>Initialization</tt> state, the client tries to connect to a TCP server that will receive the data. This will appear confusing at first because the <i>client application</i> needs to act as a server, but it is more flexible as the BCI2000 <i>SignalSharing</i> component may open and close connections, and send data, as it fits the current BCI2000 state of operation.
</p>
<h2><span class="mw-headline" id="Data_Transmission">Data Transmission</span></h2>
<p>Immediately after opening the connection, <i>SignalSharing</i> sends a number of <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor=2:_Parameter_Format" title="Technical Reference:BCI2000 Messages">Parameter</a> messages to share the parameters that are present in the system. The client may choose to ignore them, or use them for its own purposes.
</p><p>Following parameter messages, <i>SignalSharing</i> sends a <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor_Supplement=3:_Signal_Properties" title="Technical Reference:BCI2000 Messages">SignalProperties</a> message to announce meta-information about the filter's output signal, such as channel names, physical units, etc. The <tt>sourceID</tt> field of the signal properties message equals the string "Signal".
</p><p>If configured to send state information, <i>SignalSharing</i> will send another <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor_Supplement=3:_Signal_Properties" title="Technical Reference:BCI2000 Messages">SignalProperties</a> message conveying meta-information about a signal that accommodates state information. This message's <tt>sourceID</tt> field will equal the string "States".
</p><p>Subsequently, <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor_Supplement=1:_Signal_Data" title="Technical Reference:BCI2000 Messages">signal data</a> are sent whenever a signal leaves the filter for which <i>SignalSharing</i> is enabled. The signal data's <tt>sourceID</tt> field will contain the string "Signal".
</p><p>Signal data contains a flag that indicates whether full signal data is sent, or just the name of a shared memory block. For local connections (i.e., connections to a local address of the machine BCI2000 is running on), the name of a shared memory block is sent, so you may attach to that block and read data from there. Between two subsequent times the user presses "Set Config" in the Operator interface, the shared memory block will remain the same, i.e. the signal data message will always contain the same shared memory name. Still, the message is necessary to indicate that a new data block is available.
</p><p>If configured to so, <i>SignalSharing</i> will follow each brain signal data message with another signal message which holds state information. The state information message is a <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor_Supplement=1:_Signal_Data" title="Technical Reference:BCI2000 Messages">signal data</a> message in which individual states correspond to channels, and state samples correspond to elements. This signal data's <tt>sourceID</tt> field will contain the string "States".
</p><p>Depending on position in the signal processing chain, the number of state samples may differ from the number of signal samples/elements because the number of state samples will always be identical to brain signal source block size, whereas the number of signal samples/elements depends on the position in the chain.
</p>
<h2><span class="mw-headline" id="Back_Channel">Back Channel</span></h2>
<p><i>SignalSharing</i> allows to send signal data as well as state data back to BCI2000. Signal data must have the same dimensions as the signal received through <i>SignalSharing</i>, and is sent as a <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor_Supplement=1:_Signal_Data" title="Technical Reference:BCI2000 Messages">signal data</a> message.
Similarly, state data is sent as a <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor_Supplement=0:_Original_State_Format" title="Technical Reference:BCI2000 Messages">state</a> message. In this state message, Length, ByteLocation, and BitLocation fields are ignored; only Name and Value fields are used.
</p><p>To allow for synchronization between signal and state changes received from the client, no action is taken until another message is received. That message is a special <a href="Technical_Reference%253ABCI2000_Messages.html#Descriptor=6:_System_Command" title="Technical Reference:BCI2000 Messages">system command</a> message with content <i>EndOfData</i>. Once this message has been received, signal and state changes will be applied the next time the shared filter's data have been updated inside the BCI2000 processing chain.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Similar to visualizations, the system creates two parameters for each active filter, and places those under the <i>SignalSharing</i> tab in the Operator's config dialog (or multiple <i>SignalSharing</i> tabs in more complex signal processing configurations).
</p><p>By default, these parameters are empty strings; to activate <i>SignalSharing</i> for a certain filter, set the parameter <b>Share&lt;FilterName&gt;</b> to an ip address and port to connect to, e.g.
</p>
<pre>localhost:1879
</pre>
<p>To activate state sharing in addition to signal sharing, set the parameter <b>Share&lt;FilterName&gt;States</b> to a list of state names. In the transmitted signal that holds state information, channels will correspond to states in the order specified in the <b>Share&lt;FilterName&gt;States</b> parameter.
Also, any state whose value is going to be changed from the client side must be listed in the <b>Share&lt;FilterName&gt;States</b> parameter.
</p>
<h2><span class="mw-headline" id="Client_Examples">Client Examples</span></h2>
<ul><li>An example for a <i>SignalSharing</i> client application in C++: <a href="Programming_Reference%253ASignalSharingDemoClient_C++_App.html" title="Programming Reference:SignalSharingDemoClient C++ App">SignalSharingDemoClient C++ App</a></li>
<li>An example for a <i>SignalSharing</i> client application in Python: <a href="Programming_Reference%253ASignalSharing_Python_Demo.html" title="Programming Reference:SignalSharing Python Demo">SignalSharing Python Demo</a></li></ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<p><a href="Technical_Reference%253ABCI2000_Messages.html" title="Technical Reference:BCI2000 Messages">Technical Reference:BCI2000 Messages</a>,  <a href="User_Tutorial%253ABCI2000Remote.html" title="User Tutorial:BCI2000Remote">User Tutorial:BCI2000Remote</a>,
<a href="Programming_Reference%253AGenericSignal_Class.html" title="Programming Reference:GenericSignal Class">Programming Reference:GenericSignal Class</a>,  
<a href="Programming_Reference%253ASignalSharingDemoClient_C++_App.html" title="Programming Reference:SignalSharingDemoClient C++ App">Programming Reference:SignalSharingDemoClient C++ App</a>,
<a href="Programming_Reference%253ASignalSharing_Python_Demo.html" title="Programming Reference:SignalSharing Python Demo">SignalSharing Python Demo</a>
</p>
<!-- 
NewPP limit report
Cached time: 20241129160848
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.021 seconds
Real time usage: 0.024 seconds
Preprocessor visited node count: 31/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key wikidb-bci_:pcache:idhash:2700-0!canonical and timestamp 20241129160848 and revision id 11642.
 -->
</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://www.bci2000.org/mediawiki/index.php?title=User_Reference:SignalSharing&amp;oldid=11642">http://www.bci2000.org/mediawiki/index.php?title=User_Reference:SignalSharing&amp;oldid=11642</a>"</div>
 </div>
</body>
</html>